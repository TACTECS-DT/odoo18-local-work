<odoo>
    <template id="portal_my_operations_edit" name="Edit Operation">
        <t t-call="portal.portal_layout">

            <t t-if="operation">
                <div class="card-header">
                    <div class="row">
                        <h3 class="card-title col-6">
                            <span t-field="operation.name"/>
                        </h3>
                        <div class="col-6 text-right">
                            <div class="d-inline-block">
                                <div t-foreach="operation" t-as="tf" class="float-left"
                                     style="font-size: 20px">
                                    <span t-att-class="'badge badge-success' if tf.state=='confirm' else '' 'badge badge-primary' if tf.state=='reviewed' else '' 'badge badge-danger' if tf.state=='cancel' else '' 'badge badge-warning' if tf.state=='freezed' else '' 'badge badge-light' if tf.state=='draft' else '' 'badge badge-info' if tf.state=='so_created' else ''"
                                          t-field="tf.state"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br/>
                <div id="op_form_ahmed">
                
                <form t-att-action="'/my/operation/edit/%s' % (operation.id)" method="post"
                      class="container-fluid mt32 op_edit_form" id="op_edit_form" name="op_edit_form"
                      enctype="multipart/form-data">
 <link rel="stylesheet" href="/web/static/lib/jquery.ui/jquery-ui.css"/>  

                    <input type="hidden" name="csrf_token"
                           t-att-value="request.csrf_token()"/>
                    <input type="hidden" name="current_op_id" readonly="True" id="current_op_id" class="current_op_id"
                           t-att-value="operation.id"/>
                    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.5/js/select2.min.js"></script> -->
                    <link rel="stylesheet" href="/portal_custom/static/src/css/select2.css" type="text/css"/>
                    <!-- <script type="text/javascript" src="/web/static/lib/jquery/jquery.js"/> -->
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">Operation
                                Details</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Operation Type
                                        <span style="color:red">*</span>
                                    </label>
                                    <select class="form-control  operation_type_id operation_type"
                                            required="required"
                                            name="operation_type"
                                            id="operation_type">
                                        <option
                                                t-att-value="operation.operation_type.id">
                                            <t t-esc="operation.operation_type.name"/>
                                        </option>
                                        <t t-foreach="operation_type"
                                           t-as="types">
                                            <option
                                                    t-att-value="types.id">
                                                <t t-esc="types.name"/>
                                            </option>
                                        </t>
                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Type
                                        <span style="color:red">*</span>
                                    </label>
                                    <select class="form-control op_type"
                                            required="required"
                                            name="op_type"
                                            id="op_type">


                                        <option t-att-value="operation.op_type"
                                                t-if="operation.op_type"
                                                t-field="operation.op_type"
                                                disabled="disabled">
                                        </option>
                                        <option value="private">
                                            Private</option>
                                        <option value="tender">Waiting
                                            List</option>
                                        <option value="supply_order">Supply
                                            Order</option>

                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="col-md-12 col-form-label m-0 font-weight-bold text-primary"
                                           for="start_datetime">Date Start
                                        <span style="color:red">*</span>
                                    </label>
                                    <div class="input-group date">

                                        <input type="text"
                                               name="start_datetime"
                                               id="start_datetime"
                                               required="required"
                                               class="form-control start_datetime"
                                               t-att-value="operation.start_datetime"
                                               placeholder="YYYY-MM-DD">

                                        </input>
                                        <div class="input-group-append">
                                            <span class="input-group-text">
                                                <span class="fa fa-calendar"
                                                      role="img"
                                                      aria-label="Calendar"></span>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Side
                                        <span style="color:red">*</span>
                                    </label>
                                    <select class="form-control side"
                                            required="required"
                                            name="side"
                                            id="side">


                                        <option t-att-value="operation.side"
                                                t-if="operation.side"
                                                t-field="operation.side"
                                        >
                                        </option>
                                        <option value="r">
                                            Right</option>
                                        <option value="l">Left</option>


                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Sales Channel
                                        <span style="color:red">*</span>
                                    </label>
                                    <select class="form-control  op_sales_area_id op_sales_area"
                                            disabled="1"
                                            required="required"
                                            name="op_sales_area"
                                            id="op_sales_area">

                                        <t t-foreach="operations_teams"
                                           t-as="team">
                                            <option t-field="team.name"
                                                    t-att-selected="operation.op_sales_area.id == team.id"
                                                    t-att-value="team.id">

                                            </option>
                                        </t>
                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Area Manager
                                    </label>
                                    <div class="input-group">
                                        <input type="text"
                                               name="op_area_manager"
                                               id="op_area_manager"
                                               readonly="True"
                                               class="form-control op_area_manager"
                                               t-att-value="operation.op_area_manager.name"
                                        />

                                    </div>


                                </div>


                                <div class="form-group col-md-4">
                             <label class="m-0 font-weight-bold text-primary">Delivery Type
                                </label>
                                <div class="input-group">

                                    <select class="form-control delivery_type" name="delivery_type" id="delivery_type" >
                                    <option value="">--- Select --</option>
                                    <option value="delivery2customer" t-att-selected="operation.operation_delivery_type == 'delivery2customer'">Delivery To Customer</option>
                                    <option value="delivery2tender" t-att-selected="operation.operation_delivery_type == 'delivery2tender'">Delivery To Tender</option>
                                    <option value="deliveryorder" t-att-selected="operation.operation_delivery_type == 'deliveryorder'">Delivery Order</option>
                                    <option value="loading" t-att-selected="operation.operation_delivery_type == 'loading'">Loading</option>
                                    <option value="exchange" t-att-selected="operation.operation_delivery_type == 'exchange'">Exchange</option>
                                    <option value="replacement" t-att-selected="operation.operation_delivery_type == 'replacement'">Replacement</option>
                                    <option value="purchasereturn" t-att-selected="operation.operation_delivery_type == 'purchasereturn'">Purchase Return</option>
                                    <option value="gov" t-att-selected="operation.operation_delivery_type == 'gov'">Government Form</option>
                                    </select>


                                </div>
                            </div>


                            <div class="form-group col-md-4 ui-widget">
                             <label class="m-0 font-weight-bold text-primary">Sale Order
                                </label>
                                <div class="input-group">
                                <input name="sale_order" id="sale_order" t-att-value="operation.sale_order_id.name" class="form-control sale_order ui-autocomplete-input"/>
                                    <!-- <select class="form-control sale_order" name="sale_order" id="sale_order" > </select> -->
                                <!-- <span class="ui-autocomplete"></span> -->
                                <input type="hidden" t-att-value="operation.sale_order_id.id" id="sale_order_id"></input>
                                </div>
                            </div>












                            </div>
                        </div>
                    </div>
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">Patient
                                Details</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Patient Name
                                        <span style="color:red">*</span>
                                    </label>
                                    <div class="form-group">
                                        <div class="input-group">
                                            <input type="text"
                                                   name="patient_name"
                                                   id="patient_name"
                                                   required="required"
                                                   class="form-control patient_name"
                                                   t-att-value="operation.patient_name"
                                            />

                                        </div>
                                    </div>
                                </div>

                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Patient Gender
                                        <span style="color:red">*</span>
                                    </label>
                                    <select class="form-control patient_gender"
                                            required="required"
                                            name="patient_gender"
                                            id="patient_gender">
                                        <option t-if="operation.patient_gender == 'm'"
                                                selected="selected"
                                                value="m"
                                                disabled="disabled">Male</option>
                                        <option
                                                t-if="operation.patient_gender == 'f'"
                                                selected="selected"
                                                value="m"
                                                disabled="disabled">Female</option>

                                        <option value="m">Male</option>
                                        <option value="f">
                                            Female</option>

                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Patient National ID
                                        <span style="color:red">*</span>
                                    </label>
                                    <div class="input-group">
                                        <input type="text"
                                               name="patient_national_id"
                                               id="patient_national_id"
                                               required="required"
                                               class="form-control patient_national_id"
                                               t-att-value="operation.patient_national_id"
                                        />

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">Location
                                Details</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Hospital
                                        <span style="color:red">*</span>
                                    </label>
                                    <select class="form-control hospital_id"
                                            required="required"
                                            name="hospital_id"
                                            id="hospital_id">


                                        <t t-foreach="hospitals"
                                           t-as="hos">
                                            <option t-field="hos.name"
                                                    t-att-selected="operation.hospital_id.id == hos.id"
                                                    t-att-value="hos.id">

                                            </option>
                                        </t>
                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Authority Type
                                        <span style="color:red">*</span>
                                    </label>
                                    <select disabled="1" readonly="true" class="form-control authority"
                                            required="required"
                                            name="authority"
                                            id="authority">
                                        <option t-att-value="operation.authority"
                                                selected="selected"
                                                t-field="operation.authority"
                                                disabled="disabled"></option>
                                        <option value="closed">
                                            Closed</option>
                                        <option value="open">
                                            Open</option>
                                        <option value="open_approval">
                                            Open With Approval</option>

                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Patient
                                        <span style="color:red">*</span>
                                    </label>
                                    <select class="form-control patient_id"
                                            required="required"
                                            name="patient_id"
                                            id="patient_id">

                                        <t t-foreach="patients"
                                           t-as="patient">
                                            <option t-field="patient.name"
                                                    t-att-selected="operation.patient_id.id == patient.id"
                                                    t-att-value="patient.id">

                                            </option>
                                        </t>
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Surgeon
                                        <span style="color:red">*</span>
                                    </label>
                                    <select class="form-control surgeon_id"
                                            required="required"
                                            name="surgeon_id"
                                            id="surgeon_id">

                                        <t t-foreach="surgeons"
                                           t-as="surgeon">
                                            <option t-field="surgeon.name"
                                                    t-att-selected="operation.surgeon_id.id  == surgeon.id"

                                                    t-att-value="surgeon.id">

                                            </option>
                                        </t>
                                    </select>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Doctor Phone Number
                                        <span style="color:red">*</span>
                                    </label>
                                    <div class="input-group">
                                        <input type="text"
                                               name="DoctorPhoneNum"
                                               id="DoctorPhoneNum"
                                               required="required"
                                               class="form-control DoctorPhoneNum"
                                               t-att-value="operation.DoctorPhoneNum"
                                        />

                                    </div>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Payment Methods
                                    </label>
                                    <select class="form-control payment_methods"
                                            required="required"
                                            name="payment_methods"
                                            id="payment_methods">


                                        <option t-att-value="operation.payment_methods"
                                                t-if="operation.payment_methods"
                                                t-field="operation.payment_methods"
                                                disabled="disabled">
                                        </option>
                                        <option value="cash">
                                            Cash</option>
                                        <option value="credit">
                                            Credit</option>
                                        <option value="replacement">
                                            replacement</option>
                                        <option value="hospitalcash">
                                            Hospital
                                            Cash</option>

                                    </select>

                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">X Rays</h6>

                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Pre Operative XRay
                                    </label>
                                    <t t-if="operation.attachment_pre">
                                        <a
                                                class="btn btn-primary "
                                                t-attf-href="/web/content/operation.operation/{{operation.id}}/attachment_pre?download=1">
                                            <i class="fas fa-download"></i>
                                            Download
                                        </a>
                                    </t>
                                    <t t-else="">
                                        <div class="form-group">

                                            <div class="input-group">
                                                <div class="custom-file">
                                                    <input type="file"
                                                           name="attachment_pre"
                                                           class="custom-file-input"
                                                           id="attachment_pre"/>
                                                    <label class="custom-file-label"
                                                           for="attachment_pre">
                                                        Choose file</label>
                                                </div>

                                            </div>
                                        </div>
                                    </t>
                                </div>

                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Post Operative XRay
                                    </label>
                                    <t t-if="operation.attachment_after">
                                        <a
                                                class="btn btn-primary "
                                                t-attf-href="/web/content/operation.operation/{{operation.id}}/attachment_after?download=1">
                                            <i class="fas fa-download"></i>
                                            Download
                                        </a>
                                    </t>
                                    <t t-else="">
                                        <div class="form-group">

                                            <div class="input-group">
                                                <div class="custom-file">
                                                    <input type="file"
                                                           name="attachment_after"
                                                           class="custom-file-input"
                                                           id="attachment_after"/>
                                                    <label class="custom-file-label"
                                                           for="attachment_after">
                                                        Choose file</label>
                                                </div>

                                            </div>
                                        </div>
                                    </t>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Revised Implant
                                    </label>
                                    <t t-if="operation.attachment_paitent">
                                        <a
                                                class="btn btn-primary "
                                                t-attf-href="/web/content/operation.operation/{{operation.id}}/attachment_paitent?download=1">
                                            <i class="fas fa-download"></i>
                                            Download
                                        </a></t>

                                    <t t-else="">
                                        <div class="form-group">

                                            <div class="input-group">
                                                <div class="custom-file">
                                                    <input type="file"
                                                           name="attachment_after"
                                                           class="custom-file-input"
                                                           id="attachment_paitent"/>
                                                    <label class="custom-file-label"
                                                           for="attachment_paitent">
                                                        Choose file</label>
                                                </div>

                                            </div>
                                        </div>
                                    </t>
                                </div>
                            </div>
                            <div class="row">

                                <div class="form-group col-md-4">
                                    <label class="m-0 font-weight-bold text-primary">Joint Pre Company
                                    </label>
                                    <div class="input-group">
                                        <input type="text"
                                               name="paitent_joint_pre_company"
                                               id="paitent_joint_pre_company"
                                               required="required"
                                               class="form-control paitent_joint_pre_company"
                                               t-att-value="operation.paitent_joint_pre_company"
                                        />

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">Supply
                                Details</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <label class="m-0 font-weight-bold text-primary">Warehouse
                                        <span style="color:red">*</span>
                                    </label>
                                    <select readonly="true" class="form-control warehouse_id"
                                            required="required"
                                            name="warehouse_id"
                                            id="warehouse_id">
                                        <option selected="selected" disabled="disabled"></option>

                                        <t t-foreach="warehouses"
                                           t-as="warehouse">
                                            <option t-field="warehouse.name"
                                                    t-att-selected="operation.warehouse_id.id == warehouse.id"

                                                    t-att-value="warehouse.id">

                                            </option>
                                        </t>
                                    </select>
                                </div>
                                <div class="form-group col-md-6">
                                    <label class="m-0 font-weight-bold text-primary">Location
                                        <span style="color:red">*</span>
                                    </label>
                                    <select disabled="1" readonly="true" class="form-control location_id"
                                            required="required"
                                            name="location_id"
                                            id="location_id">
                                        <option selected="selected" disabled="disabled"></option>
                                        <t t-foreach="locations"
                                           t-as="location">
                                            <option t-field="location.name"
                                                    t-att-selected="operation.location_id.id == location.id"
                                                    t-att-value="location.id">

                                            </option>
                                        </t>
                                    </select>
                                </div>

                            </div>
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <label class="m-0 font-weight-bold text-primary">Branch
                                    </label>
                                    <div class="input-group">
                                        <input type="text"
                                               name="operation_stock_branches"
                                               id="operation_stock_branches"
                                               readonly="True"
                                               class="form-control operation_stock_branches"
                                               t-att-value="operation.operation_stock_branches.name"
                                        />

                                    </div>

                                </div>
                                <div class="form-group col-md-6">
                                    <label class="m-0 font-weight-bold text-primary">Is Operation Location
                                        Freeze
                                    </label>

                                    <div class="input-group">
                                        <input type="text"
                                               name="is_operation_freeze"
                                               id="is_operation_freeze"
                                               readonly="True"
                                               class="form-control is_operation_freeze"
                                               t-att-value="operation.is_operation_freeze"
                                        />

                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="card shadow mb-4">

                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="card card-primary card-tabs">
                                        <div class="card-header p-0 pt-1">
                                            <ul class="nav nav-tabs "
                                                id="custom-tabs-one-tab" role="tablist">
                                                <li class="nav-item">
                                                    <a class="nav-link active"
                                                       id="components-tab"
                                                       data-toggle="pill"
                                                       href="#components"
                                                       role="tab"
                                                       aria-controls="components"
                                                       aria-selected="true">
                                                        Components</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                       id="more-items-tab"
                                                       data-toggle="pill"
                                                       href="#more-items"
                                                       role="tab"
                                                       aria-controls="more-items"
                                                       aria-selected="false">More
                                                        Items</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                       id="other-info-tab"
                                                       data-toggle="pill"
                                                       href="#other-info"
                                                       role="tab"
                                                       aria-controls="other-info"
                                                       aria-selected="false">Other
                                                        Info</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                       id="add-items-tab"
                                                       data-toggle="pill"
                                                       href="#add-items"
                                                       role="tab"
                                                       aria-controls="add-items"
                                                       aria-selected="false">Add
                                                        Items</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                       id="op-items-tab"
                                                       data-toggle="pill"
                                                       href="#op-items"
                                                       role="tab"
                                                       aria-controls="op-items"
                                                       aria-selected="false">Operation Quantities</a>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="card-body">
                                            <div class="tab-content"
                                                 id="custom-tabs-one-tabContent">
                                                <div class="tab-pane fade show active"
                                                     id="components"
                                                     role="tabpanel"
                                                     aria-labelledby="components-tab">
                                                    <div class="card-body">
                                                        <div class="row"
                                                             style="font-size: 15px;font-weight: bold">
                                                            <input type="hidden" name="component_ids_ids"
                                                                   class="component_ids_ids" id="component_ids_ids"
                                                                   t-att-value="operation.component_ids.ids"/>
                                                            <div class="col-md-12">
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-2"
                                                                           for="component_ids">
                                                                        Components:</label>
                                                                    <select class="form-control select2-multi component_ids"
                                                                            name="component_ids[]"
                                                                            id="component_ids"
                                                                            multiple="multiple">

                                                                        <t t-foreach="components"
                                                                           t-as="component">
                                                                            <option
                                                                                    t-att-selected="component.id in operation.component_ids.ids"
                                                                                    t-att-value="component.id">
                                                                                <t t-esc="component.name_get()"/>
                                                                            </option>
                                                                        </t>
                                                                    </select>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade"
                                                     id="more-items"
                                                     role="tabpanel"
                                                     aria-labelledby="more-items-tab">
                                                    <div class="invoice-box table-responsive">
                                                        <table class="table table-bordered table-scroll mt-3"
                                                               id="invoice">
                                                            <thead>
                                                                <tr>
                                                                    <th scope="col">Product</th>
                                                                    <th scope="col">Quantity</th>
                                                                    <th scope="col">

                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody class="multi">
                                                                <t t-if="not operation.product_lines">
                                                                    <tr id="addPart">
                                                                        <input type="hidden"
                                                                               name="operation_id"/>
                                                                        <input type="hidden"
                                                                               name="product_id"/>
                                                                        <td>
                                                                            <select class="form-control op_add_product_id"
                                                                                    name="op_add_product_id"
                                                                                    required="required">
                                                                                <option value="" selected="selected"
                                                                                        disabled="disabled">Select
                                                                                </option>
                                                                                <t t-foreach="products" t-as="product">
                                                                                    <option
                                                                                            t-att-value="product.id">
                                                                                        <t t-esc="product.name"/>
                                                                                    </option>
                                                                                </t>
                                                                            </select>
                                                                        </td>
                                                                        <td>
                                                                            <input type="number"
                                                                                   min="1"
                                                                                   name="quantity"
                                                                                   class="form-control"/>
                                                                        </td>

                                                                        <td>

                                                                                                     <button class="btn btn-danger remove">
                                                                    <i class="fa fa-times"
                                                                       aria-hidden="true"></i>
                                                                </button>

                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td colspan="3">
                                                                            <button type="button" id="addProduct"
                                                                                    class="btn btn-info btn-block"><i
                                                                                    class="fa fa-plus"></i> Add a
                                                                                line</button>
                                                                        </td>
                                                                    </tr>
                                                                </t>
                                                                <t t-else="">
                                                                    <tr id="addPart" t-foreach="operation.product_lines"
                                                                        t-as="line">
                                                                        <input type="hidden" t-att-value="line.id"
                                                                               name="line_id"/>
                                                                        <input type="hidden"
                                                                               t-att-value="line.operation_id.id"
                                                                               name="operation_id"/>
                                                                        <input type="hidden"
                                                                               t-att-value="line.product_id.id"
                                                                               name="product_id"/>
                                                                        <td>
                                                                            <select class="form-control op_add_product_id"
                                                                                    name="op_add_product_id"
                                                                                    required="required">
                                                                                <option value="" selected="selected"
                                                                                        disabled="disabled">Select
                                                                                </option>
                                                                                <t t-foreach="products" t-as="product">
                                                                                    <option t-att-selected="line.product_id.id == product.id"
                                                                                            t-att-value="product.id">
                                                                                        <t t-esc="product.name"/>
                                                                                    </option>
                                                                                </t>
                                                                            </select>
                                                                        </td>
                                                                        <td>
                                                                            <input type="number"
                                                                                   t-att-value="line.quantity" min="1"
                                                                                   name="quantity"
                                                                                   class="form-control"/>
                                                                        </td>

                                                                        <td>

                                                                            <a t-attf-href="/my/operation/product/line/delete/#{line['id']}"
                                                                               class="btn btn-danger remove">
                                                                                <i class="fas fa-trash"></i>Delete
                                                                            </a>

                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td colspan="3">
                                                                            <button type="button" id="addProduct"
                                                                                    class="btn btn-info btn-block"><i
                                                                                    class="fa fa-plus"></i> Add a
                                                                                line</button>
                                                                        </td>
                                                                    </tr>
                                                                </t>
                                                            </tbody>
                                                        </table>
                                                    </div>

                                                </div>
                                                <div class="tab-pane fade"
                                                     id="other-info"
                                                     role="tabpanel"
                                                     aria-labelledby="other-info-tab">
                                                    <div class="row">
                                                        <div class="card-header py-3">
                                                            <h6 class="m-0 font-weight-bold text-primary">
                                                                Notes</h6>


                                                        </div>

                                                        <div class="col-md-12">
                                                            <textarea class="form-control op_notes" rows="3"
                                                                      name="op_notes"
                                                                      style="margin-top: 0px; margin-bottom: 0px; height: 81px;">
                                                                <t t-esc="operation.notes"/>

                                                            </textarea>
                                                        </div>

                                                    </div>
                                                    <div class="row">
                                                        <div class="card-header py-3">
                                                            <h6 class="m-0 font-weight-bold text-primary">
                                                                Hospital Notes</h6>
                                                        </div>
                                                        <div class="col-md-12">
                                                            <textarea class="form-control hospital_additional_notes"
                                                                      rows="3"
                                                                      name="hospital_additional_notes"
                                                                      style="margin-top: 0px; margin-bottom: 0px; height: 81px;">
                                                                <t t-esc="operation.hospital_additional_notes"/>
                                                            </textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade"
                                                     id="add-items"
                                                     role="tabpanel"
                                                     aria-labelledby="add-items-tab">
                                                    <table class="table table-bordered table-scroll mt-3"
                                                           id="more_product">
                                                        <thead>
                                                            <tr>
                                                                <th>Product</th>
                                                                <th>Internal</th>
                                                                <th>External</th>
                                                                <th>Empties</th>
                                                                <th scope="col">

                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody class="multi">
                                                            <t t-if="not operation.product_qunat_tab">
                                                                <tr id="add_more_product">
                                                                    <input type="hidden" name="line_id"/>
                                                                    <input type="hidden" name="operation_id"/>
                                                                    <input type="hidden" name="product_id"/>

                                                                    <td>
                                                                        <select class="form-control op_add_more_product_id"
                                                                                name="op_add_more_product_id"
                                                                                required="required">
                                                                            <option value="" selected="selected"
                                                                                    disabled="disabled">Select</option>
                                                                            <t t-foreach="products" t-as="product">
                                                                                <option t-att-value="product.id">
                                                                                    <t t-esc="product.name"/>
                                                                                </option>
                                                                            </t>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <input type="checkbox" name="internal"
                                                                               id="internal" class="checkbox"
                                                                               value="on"/>
                                                                        <input type="hidden" name="internal_hidden"
                                                                               class="hidden_text"
                                                                               value="False"/>
                                                                    </td>
                                                                    <td>
                                                                        <input type="checkbox" name="external"
                                                                               id="external" class="checkbox"
                                                                               value="on"/>
                                                                        <input type="hidden" name="external_hidden"
                                                                               class="hidden_text"
                                                                               value="False"/>
                                                                    </td>
                                                                    <td>
                                                                        <input type="checkbox" name="prod_replacement"
                                                                               id="prod_replacement" class="checkbox"
                                                                               value="on"/>
                                                                        <input type="hidden" name="replacement_hidden"
                                                                               class="hidden_text"
                                                                               value="False"/>
                                                                    </td>
                                                                    <td>
                                                                        <button class="btn btn-danger remove">
                                                                            <i class="fa fa-times"
                                                                               aria-hidden="true"></i>
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="5">
                                                                        <button type="button"
                                                                                class="btn btn-info btn-block"
                                                                                id="addMoreProduct">
                                                                            <i class="fas fa-plus"></i> Add
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                            </t>
                                                            <t t-else="">
                                                                <tr id="add_more_product"
                                                                    t-foreach="operation.product_qunat_tab" t-as="line">
                                                                    <input type="hidden" t-att-value="line.id"
                                                                           name="line_id"/>
                                                                    <input type="hidden"
                                                                           t-att-value="line.operation_id.id"
                                                                           name="operation_id"/>
                                                                    <input type="hidden"
                                                                           t-att-value="line.product_id.id"
                                                                           name="product_id"/>

                                                                    <td>
                                                                        <select class="form-control op_add_more_product_id"
                                                                                name="op_add_more_product_id"
                                                                                required="required">
                                                                            <option value="" selected="selected"
                                                                                    disabled="disabled">Select
                                                                            </option>
                                                                            <t t-foreach="products" t-as="product">
                                                                                <option t-att-selected="line.product_id.id == product.id"
                                                                                        t-att-value="product.id">
                                                                                    <t t-esc="product.name"/>
                                                                                </option>
                                                                            </t>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <input type="checkbox"
                                                                               name="internal"
                                                                               id="internal"
                                                                               t-att-checked="line.internal"
                                                                               class="checkbox" value="on">
                                                                        </input>

                                                                        <input type="hidden" name="internal_hidden"
                                                                               id="internal_hidden" class="hidden_text"
                                                                               t-att-value="line.internal  or 'False'"/>


                                                                        <!--                                                                            <input type="hidden" name="internal" t-if="internal"-->
                                                                        <!--                                                                                   value="False"/>-->

                                                                    </td>
                                                                    <td>
                                                                        <input type="checkbox"
                                                                               name="external"
                                                                               id="external"
                                                                               t-att-checked="line.external"
                                                                               class="checkbox" value="on">
                                                                        </input>
                                                                        <input type="hidden" name="external_hidden"
                                                                               id="external_hidden" class="hidden_text"
                                                                               t-att-value="line.external  or 'False'"/>

                                                                        <!--                                                                            <input type="hidden" name="external"-->
                                                                        <!--                                                                                   value="False"/>-->

                                                                    </td>
                                                                    <td>
                                                                        <input type="checkbox"
                                                                               name="prod_replacement"
                                                                               id="prod_replacement"
                                                                               t-att-checked="line.prod_replacement"
                                                                               class="checkbox" value="on">
                                                                        </input>

                                                                        <input type="hidden"
                                                                               name="replacement_hidden"
                                                                               id="replacement_hidden"
                                                                               class="hidden_text"
                                                                               t-att-value="line.prod_replacement  or 'False'"/>

                                                                        <!--                                                                            <input type="hidden" name="prod_replacement"-->
                                                                        <!--                                                                                   value="False"/>-->

                                                                    </td>

                                                                    <td>

                                                                        <a t-attf-href="/my/operation/product/line/more/delete/#{line['id']}"
                                                                           class="btn btn-danger remove">
                                                                            <i class="fas fa-trash"></i>Delete
                                                                        </a>

                                                                    </td>
                                                                </tr>

                                                                <tr>
                                                                    <td colspan="5">
                                                                        <button type="button" id="addMoreProduct"
                                                                                class="btn btn-info btn-block">
                                                                            <i class="fa fa-plus"></i> Add a
                                                                            line</button>
                                                                    </td>
                                                                </tr>
                                                            </t>
                                                        </tbody>
                                                    </table>

                                                </div>

                                                <div class="tab-pane fade"
                                                     id="op-items"
                                                     role="tabpanel"
                                                     aria-labelledby="op-items-tab">
                                                     <div class="row">
                                                        <a t-attf-href="/my/operation/freez/{{operation.id}}" class="btn btn-primary createfreezitem">Make Items Freez</a>
                                                     </div>
                                                    <table class="table table-bordered table-scroll mt-3"
                                                           id="op_quant">
                                                        <thead>
                                                            <tr>
                                                                <!-- <th></th> -->
                                                                <th>Product</th>
                                                                <th>Product Category</th>
                                                                <th>Quantity</th>
                                                                <th>Company</th>
                                                                <th>Location / Warehouse</th>
                                                                <th scope="col">

                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody class="multi">
                                                          <t t-foreach="operationQuantities" t-as="opquant">
                                                          <tr>
                                                            <!-- <td><input type="checkbox" id="opquant[ ]" name="opquant[ ]" t-att-value="opquant.id"/></td> -->
                                                          <td>
                                                           <t t-esc="opquant.product_id.name"/>
                                                          </td>
                                                          <td>
                                                           <t t-esc="opquant.product_categ_id.name"/>
                                                          </td>
                                                          <td>
                                                           <t t-esc="opquant.quantity"/>
                                                          </td>
                                                          <td>
                                                           <t t-esc="opquant.company_id.name"/>
                                                          </td>
                                                          <td>
                                                           <t t-esc="opquant.location_id_warehouse_id"/>
                                                          </td>
                                                          </tr>
                                                          </t>  
                                                            
                                                        </tbody>
                                                    </table>

                                                </div>



                                            </div>
                                        </div>
                                        <!-- /.card -->
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                    <div class="card-footer">
                        <button type="submit" class="btn btn-primary submit-button">
                            <i class="fa fa-paper-plane"></i>
                            Save
                        </button>
                    </div>
                    <script>
                        function  multiSelectWithoutCtrl(elemSelector){

                            console.log("option entered msg");
                            let options = [].slice.call(document.querySelectorAll("#component_ids option"));
                            options.forEach(function (element) {
                                console.log("option foreach");
                                element.addEventListener("mousedown", 
                                    function (e) {
                                        e.preventDefault();
                                        element.parentElement.focus();
                                        this.selected = !this.selected;
                                        return false;
                                    }, false );
                            });
    
    
    
                        }
                        window.onload = function() {
                            $("#component_ids").on('click',function(){
                                console.log("option clicked");
                              multiSelectWithoutCtrl('#component_ids'); 
                            });
                        ;
                    } 
                        <!-- $('.component_ids').select2({

                        });  -->
                  
                        <!-- function updateValue(checkbox) {
                        var textInput = checkbox.parentNode.nextElementSibling.firstChild;
                        if (checkbox.checked) {
                        textInput.value = "True";
                        } else {
                        textInput.value = "False";
                        }
                        }
                      
                        
                        
                        $('.patient_id').select2();
                        $('.operation_type').select2({

                        });


                        $('.op_sales_area').select2({

                        });
                        $('.hospital_id').select2({


                        });

                        $('.surgeon_id').select2({

                        });
                        $('.warehouse_id').select2({

                        });
                        $('.location_id').select2({

                        }); -->


                    </script>
                   
                    <!-- <script src="/portal_custom/static/src/js/select2.min.js"></script> -->
                
                </form>
                </div>
            </t>

        </t>
    </template>

</odoo>